<div class="capacity__container">
  <a *ngIf="flagEnd" routerLink="/capacity-join" class="button-back">
    <div class="button-back__icon">
      <i class="fa-solid fa-left-long"></i>
    </div>
    ThoÃ¡t
  </a>

  <header class="capacity__header" *ngIf="!flagEnd && flagStart && !flagLoadingNextQuestion">
    <div class="capacity__header-top">{{ question.type === 1 ? "Nhiá»u Ä‘Ã¡p Ã¡n Ä‘Ãºng" : "Má»™t Ä‘Ã¡p Ã¡n Ä‘Ãºng" }}</div>

    <div class="capacity__header-bottom" [innerHTML]="question.content">.</div>
  </header>

  <ng-container *ngIf="!flagEnd; else elseTemplate">
    <main *ngIf="!flagStart; else elseFlag">
      <p class="text-white text-center fs-5 mb-3">Chá» mÃ¡y chá»§ khá»Ÿi Ä‘á»™ng!</p>

      <ul class="list-users d-flex align-items-center flex-wrap" *ngIf="users.length">
        <li *ngFor="let user of users" class="list-users__item">
          <div nz-tooltip [nzTooltipTitle]="user.email" nzTooltipColor="#000">
            <span>{{ user.name }}</span>
            <span *ngIf="user.id === userLogged.id"> (Báº¡n)</span>
          </div>
        </li>
      </ul>

      <ul class="list-users d-flex align-items-center flex-wrap justify-content-center" *ngIf="!users.length">
        <span>Báº¡n lÃ  ngÆ°á»i Ä‘áº§u tiÃªn!</span>
      </ul>
    </main>

    <!-- play game -->
    <ng-template #elseFlag>



      <div class="p-2 top-user">
        <!-- Rank -->
        <ul class="list-users align-items-center m-0">
          <li *ngFor="let usersRank of usersRanks; let key = index" class="list-users__item">
            Top {{ key + 1 }} : {{ usersRank.user.name }} {{ usersRank.true_answer }}
          </li>
        </ul>
      </div>

      <ng-container *ngIf="flagLoadingNextQuestion; else elseFlagLoadingNextQuestion">
        <div   class="my-history text-center">
          <h2 style="color:white">Cá»‘ gáº¯ng cho cÃ¢u há»i tiáº¿p theo nhÃ© ğŸ¤© <img style="width: 400px;" src="https://quizizz.com/media/resource/gs/quizizz-media/quizzes/d7c360d0-40e5-4d54-b9c4-ac3c6998d26c" alt=""></h2>
          <br>

        </div>

      </ng-container>

      <ng-template #elseFlagLoadingNextQuestion>
         <!-- Question take -->
        <div class="answers row g-4 row-cols-1 row-cols-md-2">
          <div *ngFor="let answer of question.answers">
            <div (click)="clickAnswer(answer.id)" class="answer {{ answer.status ? 'active' : '' }}">
              {{ answer.content }}
            </div>
          </div>
        </div>
        <!-- Submit -->
        <button style="float:right" (click)="submitQuestion()" class="mt-2 btn button-fpt"
          *ngIf="exam.type == 1 && !loadingSubmit">CÃ¢u
          tiáº¿p theo</button>
        <button style="float:right" (click)="submitQuestion()" class="mt-2 btn button-fpt"
          *ngIf="exam.type == 1 && loadingSubmit">Äang chuyá»ƒn cÃ¢u </button>
      </ng-template>





    </ng-template>
  </ng-container>
  <ng-template #elseTemplate>
    <h2 class=" title">TrÃ² chÆ¡i Ä‘Ã£ káº¿t thÃºc</h2>
    <div *ngIf="userRank" class="my-history">
      <!-- <p>{{ userRank.user.name }}</p> -->
      <p>Äiá»ƒm : {{ userRank.scores }}</p>
      <p>Sá»‘ cÃ¢u tráº£ lá»i Ä‘Ãºng : {{ userRank.true_answer }}</p>
      <p>Sá»‘ cÃ¢u tráº£ lá»i sai : {{ userRank.false_answer }}</p>
      <p>Sá»‘ cÃ¢u khÃ´ng tráº£ lá»i : {{ userRank.donot_answer }}</p>
    </div>
    <ul class="list-users top-user align-items-center">
      <li *ngFor="let usersRank of usersRanks; let key = index" class="list-users__item">
        Top {{ key + 1 }} : {{ usersRank.user.name }} {{ usersRank.true_answer }}
      </li>
    </ul>
  </ng-template>

  <footer class="capacity__footer d-flex align-items-center">
    <span class="user-name">{{ userLogged.name }}</span>
    <span class="user-point" *ngIf="rank">Top {{ rank }}</span>
  </footer>
</div>
